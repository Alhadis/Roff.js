"use strict";const fontStyles={AB:["ITC Avant Garde Gothic, URW Gothic L, URW Gothic, Gothic L, sans-serif","600"],ABI:["ITC Avant Garde Gothic, URW Gothic L, URW Gothic, Gothic L, sans-serif","600","oblique"],AI:["ITC Avant Garde Gothic, URW Gothic L, URW Gothic, Gothic L, sans-serif","oblique"],AR:["ITC Avant Garde Gothic, URW Gothic L, URW Gothic, Gothic L, sans-serif"],BMB:["ITC Bookman, URW Bookman L, URW Bookman, Bookman L, Bookman, serif","600"],BMBI:["ITC Bookman, URW Bookman L, URW Bookman, Bookman L, Bookman, serif","600","oblique"],BMI:["ITC Bookman, URW Bookman L, URW Bookman, Bookman L, Bookman, serif","oblique"],BMR:["ITC Bookman, URW Bookman L, URW Bookman, Bookman L, Bookman, serif"],CB:["Courier, Nimbus Mono PS, Nimbus Mono L, Nimbus Mono, monospace","bold"],CBI:["Courier, Nimbus Mono PS, Nimbus Mono L, Nimbus Mono, monospace","bold","italic"],CI:["Courier, Nimbus Mono PS, Nimbus Mono L, Nimbus Mono, monospace","italic"],CR:["Courier, Nimbus Mono PS, Nimbus Mono L, Nimbus Mono, monospace"],EURO:["FreeEuro, sans-serif"],HB:["Helvetica, Helvetica Neue, Nimbus Sans, Nimbus Sans L, Arial, sans-serif","bold"],HBI:["Helvetica, Helvetica Neue, Nimbus Sans, Nimbus Sans L, Arial, sans-serif","bold","italic"],HI:["Helvetica, Helvetica Neue, Nimbus Sans, Nimbus Sans L, Arial, sans-serif","italic"],HR:["Helvetica, Helvetica Neue, Nimbus Sans, Nimbus Sans L, Arial, sans-serif"],HNB:["Helvetica Narrow, Nimbus Sans Narrow, Arial Narrow, sans-serif","bold"],HNBI:["Helvetica Narrow, Nimbus Sans Narrow, Arial Narrow, sans-serif","bold","italic"],HNI:["Helvetica Narrow, Nimbus Sans Narrow, Arial Narrow, sans-serif","italic"],HNR:["Helvetica Narrow, Nimbus Sans Narrow, Arial Narrow, sans-serif"],NB:["New Century Schoolbook, Century Schoolbook L, C059, Century Schoolbook, serif","bold"],NBI:["New Century Schoolbook, Century Schoolbook L, C059, Century Schoolbook, serif","bold","italic"],NI:["New Century Schoolbook, Century Schoolbook L, C059, Century Schoolbook, serif","italic"],NR:["New Century Schoolbook, Century Schoolbook L, C059, Century Schoolbook, serif"],PB:["Palatino, URW Palladio L, Palladio L, P052, Palatino Linotype, serif","bold"],PBI:["Palatino, URW Palladio L, Palladio L, P052, Palatino Linotype, serif","bold","italic"],PI:["Palatino, URW Palladio L, Palladio L, P052, Palatino Linotype, serif","italic"],PR:["Palatino, URW Palladio L, Palladio L, P052, Palatino Linotype, serif"],S:["Standard Symbols PS, Standard Symbols L, Symbol, serif"],SS:["Standard Symbols PS, Standard Symbols L, Symbol, serif","oblique"],TB:["Times, Nimbus Roman No9 L, Nimbus Roman, serif","bold"],TBI:["Times, Nimbus Roman No9 L, Nimbus Roman, serif","bold","italic"],TI:["Times, Nimbus Roman No9 L, Nimbus Roman, serif","italic"],TR:["Times, Nimbus Roman No9 L, Nimbus Roman, serif"],ZCMI:["ITC Zapf Chancery, Zapf Chancery, Chancery L, URW Chancery L, Z003, cursive","italic"],ZD:["ITC Zapf Dingbats, Zapf Dingbats, D050000L, Dingbats"],"U-AB":["URW Gothic L, URW Gothic, Gothic L, sans-serif","600"],"U-ABI":["URW Gothic L, URW Gothic, Gothic L, sans-serif","600","oblique"],"U-AI":["URW Gothic L, URW Gothic, Gothic L, sans-serif","oblique"],"U-AR":["URW Gothic L, URW Gothic, Gothic L, sans-serif"],"U-BMB":["URW Bookman L, URW Bookman, Bookman L, Bookman, serif","600"],"U-BMBI":["URW Bookman L, URW Bookman, Bookman L, Bookman, serif","600","italic"],"U-BMI":["URW Bookman L, URW Bookman, Bookman L, Bookman, serif","italic"],"U-BMR":["URW Bookman L, URW Bookman, Bookman L, Bookman, serif"],"U-CB":["Nimbus Mono PS, Nimbus Mono L, Nimbus Mono, monospace","bold"],"U-CBI":["Nimbus Mono PS, Nimbus Mono L, Nimbus Mono, monospace","bold","oblique"],"U-CI":["Nimbus Mono PS, Nimbus Mono L, Nimbus Mono, monospace","oblique"],"U-CR":["Nimbus Mono PS, Nimbus Mono L, Nimbus Mono, monospace"],"U-HB":["Nimbus Sans, Nimbus Sans L, Arial, sans-serif","bold"],"U-HBI":["Nimbus Sans, Nimbus Sans L, Arial, sans-serif","bold","italic"],"U-HI":["Nimbus Sans, Nimbus Sans L, Arial, sans-serif","italic"],"U-HR":["Nimbus Sans, Nimbus Sans L, Arial, sans-serif"],"U-HNB":["Nimbus Sans Narrow, Arial Narrow, sans-serif","bold"],"U-HNBI":["Nimbus Sans Narrow, Arial Narrow, sans-serif","bold","oblique"],"U-HNI":["Nimbus Sans Narrow, Arial Narrow, sans-serif","oblique"],"U-HNR":["Nimbus Sans Narrow, Arial Narrow, sans-serif"],"U-NB":["Century Schoolbook L, C059, Century Schoolbook, serif","bold"],"U-NBI":["Century Schoolbook L, C059, Century Schoolbook, serif","bold","italic"],"U-NI":["Century Schoolbook L, C059, Century Schoolbook, serif","italic"],"U-NR":["Century Schoolbook L, C059, Century Schoolbook, serif"],"U-PB":["URW Palladio L, Palladio L, P052, Palatino Linotype, serif","bold"],"U-PBI":["URW Palladio L, Palladio L, P052, Palatino Linotype, serif","bold","italic"],"U-PI":["URW Palladio L, Palladio L, P052, Palatino Linotype, serif","italic"],"U-PR":["URW Palladio L, Palladio L, P052, Palatino Linotype, serif"],"U-S":["Standard Symbols PS, Standard Symbols L, serif"],"U-TB":["Times, Nimbus Roman No9 L, Nimbus Roman, serif","bold"],"U-TBI":["Times, Nimbus Roman No9 L, Nimbus Roman, serif","bold","italic"],"U-TI":["Times, Nimbus Roman No9 L, Nimbus Roman, serif","italic"],"U-TR":["Times, Nimbus Roman No9 L, Nimbus Roman, serif"],"U-ZCMI":["ITC Zapf Chancery, Zapf Chancery, Chancery L, URW Chancery L, Z003, cursive","italic"],"U-ZD":["D050000L, Dingbats"]};const glyphNames={space:" ",dq:'"',sh:"#",Do:"$",aq:"'",pl:"+",sl:"/",eq:"=",at:"@",lB:"[",rs:"\\",rB:"]","a^":"^",ha:"^",ru:"_",ul:"_",ga:"`",ff:"ff",Fi:"ffi",Fl:"ffl",fi:"fi",fl:"fl",lC:"{",ba:"|",or:"|",rC:"}","a~":"~",ti:"~","r!":"¡",ct:"¢",Po:"£",Cs:"¤",Ye:"¥",bb:"¦",sc:"§",ad:"¨",co:"©",Of:"ª",Fo:"«",no:"¬",tno:"¬",rg:"®","a-":"¯",de:"°","+-":"±","t+-":"±",S2:"²",S3:"³",aa:"´",mc:"µ",ps:"¶",pc:"·",ac:"¸",S1:"¹",Om:"º",Fc:"»",14:"¼",12:"½",34:"¾","r?":"¿","`A":"À","'A":"Á","^A":"Â","~A":"Ã",":A":"Ä",oA:"Å",AE:"Æ",",C":"Ç","`E":"È","'E":"É","^E":"Ê",":E":"Ë","`I":"Ì","'I":"Í","^I":"Î",":I":"Ï","-D":"Ð","~N":"Ñ","`O":"Ò","'O":"Ó","^O":"Ô","~O":"Õ",":O":"Ö",mu:"×",tmu:"×","/O":"Ø","`U":"Ù","'U":"Ú","^U":"Û",":U":"Ü","'Y":"Ý",TP:"Þ",ss:"ß","`a":"à","'a":"á","^a":"â","~a":"ã",":a":"ä",oa:"å",ae:"æ",",c":"ç","`e":"è","'e":"é","^e":"ê",":e":"ë","`i":"ì","'i":"í","^i":"î",":i":"ï",Sd:"ð","~n":"ñ","`o":"ò","'o":"ó","^o":"ô","~o":"õ",":o":"ö",di:"÷",tdi:"÷","/o":"ø","`u":"ù","'u":"ú","^u":"û",":u":"ü","'y":"ý",Tp:"þ",":y":"ÿ","'C":"Ć","'c":"ć",".i":"ı",IJ:"Ĳ",ij:"ĳ","/L":"Ł","/l":"ł",OE:"Œ",oe:"œ",vS:"Š",vs:"š",":Y":"Ÿ",vZ:"Ž",vz:"ž",Fn:"ƒ",".j":"ȷ",ah:"ˇ",ab:"˘","a.":"˙",ao:"˚",ho:"˛",'a"':"˝","*A":"Α","*B":"Β","*G":"Γ","*D":"Δ","*E":"Ε","*Z":"Ζ","*Y":"Η","*H":"Θ","*I":"Ι","*K":"Κ","*L":"Λ","*M":"Μ","*N":"Ν","*C":"Ξ","*O":"Ο","*P":"Π","*R":"Ρ","*S":"Σ","*T":"Τ","*U":"Υ","*F":"Φ","*X":"Χ","*Q":"Ψ","*W":"Ω","*a":"α","*b":"β","*g":"γ","*d":"δ","*e":"ε","*z":"ζ","*y":"η","*h":"θ","*i":"ι","*k":"κ","*l":"λ","*m":"μ","*n":"ν","*c":"ξ","*o":"ο","*p":"π","*r":"ρ",ts:"ς","*s":"σ","*t":"τ","*u":"υ","+f":"φ","*x":"χ","*q":"ψ","*w":"ω","+h":"ϑ","*f":"ϕ","+p":"ϖ","+e":"ϵ","-":"‐",hy:"‐",en:"–",em:"—","`":"‘",oq:"‘","'":"’",cq:"’",bq:"‚",lq:"“",rq:"”",Bq:"„",dg:"†",dd:"‡",bu:"•","%0":"‰",fm:"′",sd:"″",fo:"‹",fc:"›",rn:"‾","f/":"⁄",eu:"€",Eu:"€","-h":"ℏ",hbar:"ℏ",Im:"ℑ",wp:"℘",Re:"ℜ",tm:"™",Ah:"ℵ",18:"⅛",38:"⅜",58:"⅝",78:"⅞","<-":"←",ua:"↑",arrowverttp:"↑","->":"→",da:"↓",arrowvertbt:"↓",arrowvertex:"⏐","<>":"↔",va:"↕",CR:"↵",lA:"⇐",uA:"⇑",rA:"⇒",dA:"⇓",hA:"⇔",vA:"⇕",fa:"∀",pd:"∂",te:"∃",es:"∅",gr:"∇",mo:"∈",nm:"∉",st:"∋",product:"∏",coproduct:"∐",sum:"∑","\\-":"−",mi:"−","-+":"∓","**":"∗",sqrt:"√",sr:"√",pt:"∝",if:"∞","/_":"∠",AN:"∧",OR:"∨",ca:"∩",cu:"∪",is:"∫",integral:"∫",tf:"∴","3d":"∴",ap:"∼","|=":"≃","=~":"≅","~~":"≈","~=":"≈","!=":"≠","==":"≡",ne:"≢","<=":"≤",">=":"≥","<<":"≪",">>":"≫",sb:"⊂",sp:"⊃",nb:"⊄",nc:"⊅",ib:"⊆",ip:"⊇","c+":"⊕","c*":"⊗",pp:"⊥",md:"⋅",lc:"⌈",rc:"⌉",lf:"⌊",rf:"⌋",parenlefttp:"⎛",parenleftex:"⎜",parenleftbt:"⎝",parenrighttp:"⎞",parenrightex:"⎟",parenrightbt:"⎠",bracketlefttp:"⎡",bracketleftex:"⎢",bracketleftbt:"⎣",bracketrighttp:"⎤",bracketrightex:"⎥",bracketrightbt:"⎦",lt:"⎧",bracelefttp:"⎧",lk:"⎨",braceleftmid:"⎨",lb:"⎩",braceleftbt:"⎩",bv:"⎪",barex:"⎪",braceex:"⎪",braceleftex:"⎪",bracerightex:"⎪",rt:"⎫",bracerighttp:"⎫",rk:"⎬",bracerightmid:"⎬",rb:"⎭",bracerightbt:"⎭",an:"⎯",br:"│",sq:"□",lz:"◊",ci:"○",lh:"☜",rh:"☞",SP:"♠",CL:"♣",HE:"♥",DI:"♦",OK:"✓",la:"⟨",ra:"⟩",radicalex:"",registerserif:"",copyrightserif:"",trademarkserif:"",apple:""};const symbolMaps={"S SS":{"∀":34,"∃":36,"∋":39,"∗":42,"−":45,"≅":64,"Α":65,"Β":66,"Χ":67,"Δ":68,"Ε":69,"Φ":70,"Γ":71,"Η":72,"Ι":73,"ϑ":74,"Κ":75,"Λ":76,"Μ":77,"Ν":78,"Ο":79,"Π":80,"Θ":81,"Ρ":82,"Σ":83,"Τ":84,"Υ":85,"ς":86,"Ω":87,"Ξ":88,"Ψ":89,"Ζ":90,"∴":92,"⊥":94,"":96,"α":97,"β":98,"χ":99,"δ":100,"ε":101,"ϕ":102,"γ":103,"η":104,"ι":105,"φ":106,"κ":107,"λ":108,"μ":109,"ν":110,"ο":111,"π":112,"θ":113,"ρ":114,"σ":115,"τ":116,"υ":117,"ϖ":118,"ω":119,"ξ":120,"ψ":121,"ζ":122,"∼":126,"€":160,"Υ":161,"′":162,"≤":163,"⁄":164,"∞":165,"ƒ":166,"♣":167,"♦":168,"♥":169,"♠":170,"↔":171,"←":172,"↑":173,"→":174,"↓":175,"°":176,"±":177,"″":178,"≥":179,"×":180,"∝":181,"∂":182,"·":183,"÷":184,"≠":185,"≡":186,"≈":187,"…":188,"⏐":189,"⎯":190,"↵":191,"ℵ":192,"ℑ":193,"ℜ":194,"℘":195,"⊗":196,"⊕":197,"∅":198,"∩":199,"∪":200,"⊃":201,"⊇":202,"⊄":203,"⊂":204,"⊆":205,"∈":206,"∉":207,"/_":208,"∇":209,"":210,"":211,"":212,"∏":213,"√":214,"⋅":215,"¬":216,"∧":217,"∨":218,"⇔":219,"⇐":220,"⇑":221,"⇒":222,"⇓":223,"◊":224,"⟨":225,"®":226,"©":227,"™":228,"∑":229,"⎛":230,"⎜":231,"⎝":232,"⎡":233,"⎢":234,"⎣":235,"⎧":236,"⎨":237,"⎩":238,"⎪":239,"⟩":241,"∫":242,"⌠":243,"⎮":244,"⌡":245,"⎞":246,"⎟":247,"⎠":248,"⎤":249,"⎥":250,"⎦":251,"⎫":252,"⎬":253,"⎭":254,"":256}};const Postprocessor=function(){const t=0;const s=1;const e=2;const i=3;const o=4;const n=5;const a=6;const r=7;const h=8;const c=9;const l=10;const u=11;const p=12;const d=13;const f=14;const m=15;const g=16;const b=17;const x=18;const k=19;const L=20;const S=21;const y=22;const C=23;const N=24;const w=25;const v=26;const P=27;const R=28;const T=29;const M=30;const E=31;const B=32;const U=[t,t,t,t,t,t,t,t,t,s,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,s,i,i,n,i,i,i,i,i,i,i,r,i,a,h,i,c,c,c,c,c,c,c,c,c,c,i,i,i,i,i,i,i,l,l,u,p,l,l,l,d,l,l,l,l,l,f,l,l,l,l,l,l,l,m,l,g,l,l,i,i,i,i,o,i,l,l,b,x,l,k,L,S,l,l,y,l,C,N,l,w,l,v,P,R,T,M,E,B,l,l,i,i,i,i,t];127;const A=-2;const I=-3;const H=-4;const W=-5;const O=-6;const z=-8;const D=-10;const G=-11;const _=-12;const X=-13;const Z=-14;const F=-15;const V=-18;const $=-21;const Y=-22;const q=-23;const j=-40;const K=-44;const J=-48;const Q=0;const tt=1;const st=2;const et=3;const it=4;const ot=5;const nt=6;const at=7;const rt=8;const ht=9;const ct=10;const lt=11;const ut=12;const pt=13;const dt=14;const ft=15;const mt=16;const gt=17;const bt=18;const xt=19;const kt=20;const Lt=21;const St=22;const yt=23;const Ct=24;const Nt=25;const wt=26;const vt=27;const Pt=28;const Rt=29;const Tt=30;const Mt=31;const Et=32;const Bt=33;const Ut=34;const At=35;const It=36;const Ht=37;const Wt=38;const Ot=39;const zt=40;const Dt=41;const Gt=42;const _t=43;const Xt=44;const Zt=45;const Ft=46;const Vt=47;const $t=48;const Yt=49;const qt=50;const jt=[[t,t,t,t,t,A,t,t,t,F,t,z,Y,G,D,_,t,O,t,W,t,X,t,q,V,I,t,H,j,K,Z,$,J],[tt,tt,t,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt,tt],[st,st,t,t,t,A,t,t,t,st,t,z,Y,G,D,_,t,O,t,W,t,X,t,t,V,I,t,H,t,t,Z,$,J],[et,et,t,t,t,A,t,t,t,et,t,z,Y,G,D,_,t,O,t,W,t,X,t,t,V,I,t,H,t,t,Z,$,J],[it,it,t,t,t,A,t,t,t,it,t,z,Y,G,D,_,t,O,t,W,t,X,t,t,V,I,t,H,t,t,Z,$,J],[ot,ot,t,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[at,at,t,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt],[rt,t,t,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt],[ht,ht,t,t,t,A,ht,t,t,ht,t,z,Y,G,D,_,t,O,t,W,t,X,t,t,V,I,t,H,t,t,Z,$,J],[ct,ct,t,t,t,A,ct,t,ct,ct,t,z,Y,G,D,_,t,O,t,W,t,X,t,t,V,I,t,H,t,t,Z,$,J],[lt,lt,t,t,t,A,lt,t,lt,lt,t,z,Y,G,D,_,t,O,t,W,t,X,t,t,V,I,t,H,t,t,Z,$,J],[ut,ut,t,t,t,A,ut,t,ut,ut,t,z,Y,G,D,_,t,O,t,W,t,X,t,t,V,I,t,H,t,t,Z,$,J],[pt,pt,t,t,t,A,pt,t,pt,pt,t,z,Y,G,D,_,t,O,t,W,t,X,t,t,V,I,t,H,t,t,Z,$,J],[dt,t,t,t,t,A,t,t,t,ft,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[ft,t,t,mt,mt,A,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt,mt],[mt,t,t,t,t,A,t,t,t,F,t,z,Y,G,D,_,t,O,t,W,t,X,t,t,V,I,t,H,t,t,Z,$,J],[gt,t,t,t,t,A,t,t,t,bt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[bt,xt,t,t,t,t,bt,t,bt,bt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[xt,t,t,t,t,A,xt,t,xt,xt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,A,t,t,t,F,t,z,Y,G,D,_,t,O,t,W,t,X,t,t,V,I,t,H,t,t,Z,$,J],[Lt,Lt,t,Lt,Lt,A,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt,Lt],[St,St,t,t,t,A,t,t,t,t,t,t,t,t,t,t,t,yt,vt,t,Pt,t,Tt,t,t,t,At,t,t,t,t,t,t],[yt,yt,t,t,t,A,t,t,t,Ct,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Ct,Nt,t,t,t,A,t,t,t,Ct,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Nt,wt,t,t,t,A,t,t,t,Nt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[wt,t,t,t,t,A,t,t,t,wt,t,z,Y,G,D,_,t,O,t,W,t,X,t,q,V,I,t,H,t,t,Z,$,J],[t,t,t,t,t,A,t,t,t,t,t,z,Y,G,D,_,t,O,t,W,t,X,t,q,V,I,t,H,t,t,Z,$,J],[Pt,Pt,t,t,t,A,t,t,t,Rt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Rt,t,t,t,t,A,t,t,t,Rt,t,z,Y,G,D,_,t,O,t,W,t,X,t,q,V,I,t,H,t,t,Z,$,J],[Tt,Tt,t,t,t,A,t,t,t,Mt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Mt,Et,t,t,t,A,t,t,t,Mt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Et,Bt,t,t,t,A,t,t,t,Et,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Bt,Ut,t,t,t,A,t,t,t,Bt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Ut,t,t,t,t,A,t,t,t,Ut,t,z,Y,G,D,_,t,O,t,W,t,X,t,q,V,I,t,H,t,t,Z,$,J],[At,At,t,t,t,A,t,t,t,It,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[It,Ht,t,t,t,A,t,t,t,It,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Ht,Wt,t,t,t,A,t,t,t,Ht,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Wt,t,t,t,t,A,t,t,t,Wt,t,z,Y,G,D,_,t,O,t,W,t,X,t,q,V,I,t,H,t,t,Z,$,J],[Ot,Ot,t,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt],[zt,Dt,t,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt,zt],[Dt,Dt,t,t,t,A,Gt,t,t,Gt,t,z,Y,G,D,_,t,O,t,W,t,X,t,q,V,I,t,H,j,t,Z,$,J],[Gt,t,t,t,t,A,Gt,t,t,Gt,t,z,Y,G,D,_,t,O,t,W,t,X,t,q,V,I,t,H,j,t,Z,$,J],[_t,_t,t,t,t,A,Xt,t,t,Xt,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[Xt,Zt,t,Ft,Ft,Ft,Ft,Ft,Ft,Xt,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft],[Zt,Zt,t,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft],[Ft,t,t,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft],[Vt,Vt,t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,Yt,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t],[$t,$t,t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t,$t],[Yt,Yt,qt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt,Yt],[t,t,t,t,t,A,t,Yt,t,F,t,z,Y,G,D,_,t,O,t,W,t,X,t,q,V,I,t,H,j,K,Z,$,J],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];class Kt{beginPage(){}handleDeviceControl(){}handleDrawingCommand(){}handleUnknownCommand(){}informEOL(){}informWordSpace(){}moveByX(){}moveByY(){}moveThenPrint(){}moveToX(){}moveToY(){}printChar(){}printText(){}readComment(){}setColour(){}setFont(){}setSize(){}process(t){const s="string"===typeof t;let e="";let i=0;let o=0;const{length:n}=t;for(let a=0;a<n;++a){const[n,r]=s?[t[a],t.charCodeAt(a)]:[String.fromCharCode(t[a]),t[a]];const h=U[r];const c=jt[o][h];if(c<0){this.exec(i,e,a);i=c;o=~c;e=dt===o?n:""}else{o=c;if(0!==o)e+=n}}}exec(t,s,e){this.lastCommand=[t,s,e];switch(t){case $:this.informWordSpace();break;case j:this.printText(s);break;case O:this.printChar(s);break;case A:this.readComment(s);break;case I:this.beginPage(+s);break;case X:this.moveByX(+s);break;case Z:this.moveByY(+s);break;case G:this.moveToX(+s);break;case _:this.moveToY(+s);break;case W:this.setFont(+s);break;case H:this.setSize(+s);break;case Y:case J:case V:s=s.trim().split(/\s+/);switch(t){case J:this.handleDeviceControl(...s);break;case Y:this.handleDrawingCommand(...s);break;case V:this.informEOL(...s.map(t=>+t));break}break;case q:const e=s.substr(1).trim().split(/\s+/).map(t=>+t);this.setColour(s[0],e);break;case D:this.printChar(String.fromCharCode(+s));break;case z:this.printChar(this.getCharByName(s));break;case F:const[i,o]=s.replace(/\s+/g,"").split(/(?=.$)/);this.moveThenPrint(+i,o);break;case K:const[n,a,r]=s.match(/^(\d+)\s*(.*)$/m);this.printTrackedText(+a,r);break;default:this.handleUnknownCommand(t,s)}}getCharByName(t){if(glyphNames[t])return glyphNames[t];if(1===t.length)return t;if(/^u(?!0[A-F0-9]{4,})[A-F0-9]{4,}/.test(t)){const t=parseInt(RegExp["$&"].substr(1),16);if(t>1114111)return"";if(t>=55296&&t<=56319||t>=56320&&t<=57343)return"";return String.fromCharCode(t)}if(/^char[0-9]{1,3}$/.test(t)){const s=parseInt(t.substr(4));return s<=255?String.fromCharCode(s):""}console.warn(`Unrecognised glyph-name: ${t}`);return""}}Kt.tokenTypes={BEGIN_PAGE:I,CHAR_INDEXED:D,CHAR_LITERAL:O,CHAR_NAMED:z,COMMENT:A,DEVICE_CTRL:J,DRAWING:Y,INFORM_EOL:V,INFORM_PAD:$,MOVE_ABS_H:G,MOVE_ABS_V:_,MOVE_PRINT:F,MOVE_REL_H:X,MOVE_REL_V:Z,SET_COLOUR:q,SET_FONT:W,SET_SIZE:H,TEXT_NORMAL:j,TEXT_TRACKED:K};return Kt}();const CanvasRenderer=function(){const{tokenTypes:t}=Postprocessor;class s extends Postprocessor{constructor(){super();this.resetDrawingState();this.resetOutputProperties();this.resetFontStyles()}resetDrawingState(){this.devCmds=[];this.charHeight=0;this.charSize=0;this.colour="#000";this.drawColour="#000";this.font=["","px sans-serif"];this.invisible=false;this.lineWidth=1;this.hotspot=null;this.hotspots=[];this.hotspotHold=false;this.hotspotWrap=false;this.reversed=false;this.rotated=false;this.slant=0;this.sourceFile="";this.tm=null;this.x=0;this.y=0;if(this.context){this.context.lineCap="round";this.context.lineJoin="round";this.context.moveTo(this.x,this.y)}}resetFontStyles(){this.fixKerning=true;this.fixQuotes=true;this.fontStyles=Object.assign({},fontStyles);this.fonts=[0,0,0,0,0,0,"S","ZD"];this.fonts.forEach((t,s)=>{t&&this.mountFont(s,t)})}resetOutputProperties(){this.autoScale=true;this.sizeScale=1e3;this.scale=1;this.res=[72e3,1,1];this.pageWidth=612;this.pageHeight=792;this.unitWidth=1e3;this.charMaps={};for(const t in symbolMaps)t.split(" ").forEach(s=>this.charMaps[s]=symbolMaps[t])}process(t){this.page=[];this.pages=[this.page];this.buffer=null;this.anchors=new Map;this.bookmarks=[];this.resetDrawingState();super.process(t);if(null!==this.buffer){this.page.push(...this.buffer);this.buffer=null}this.minPageWidth=this.minPageHeight=Number.MAX_VALUE;this.maxPageWidth=this.maxPageHeight=Number.MIN_VALUE;this.pages.forEach((t,s)=>{t.index=s;if(!t.width)t.width=this.pageWidth;if(!t.height)t.height=this.pageHeight;if(t.width>this.maxPageWidth)this.maxPageWidth=t.width;if(t.width<this.minPageWidth)this.minPageWidth=t.width;if(t.height>this.maxPageHeight)this.maxPageHeight=t.height;if(t.height<this.minPageHeight)this.minPageHeight=t.height});this.bookmarks=this.resolveOutline(this.bookmarks)}exec(s,e,i){if(!s)return;const o=s===t.TEXT_NORMAL||s===t.MOVE_ABS_H;if(null!==this.buffer&&!o){if(s===t.INFORM_EOL)this.page.push(...this.buffer);else{const s=this.buffer.map(s=>{return s[0]===t.TEXT_NORMAL?s[1]:""}).join("");this.page.push([t.TEXT_NORMAL,s])}this.buffer=null}switch(s){case t.BEGIN_PAGE:this.page=[...this.pages[0]];this.page.width=this.pageWidth;this.page.height=this.pageHeight;!this.pages[e]?this.pages[e]=this.page:this.pages.splice(e,0,this.page);return;case t.DEVICE_CTRL:if(/^\s*X\S*\s+papersize=(\d+(?:\.\d+)?[icpPm]),(\d+(?:\.\d+)?[icpPm])/.test(e)){this.pageWidth=this.parseLength(RegExp.$1);this.pageHeight=this.parseLength(RegExp.$2);if(this.page){this.page.width=this.pageWidth;this.page.height=this.pageHeight}return}e=e.trim().replace(/^X\S*\s+ps:exec\b/,"X ps: exec").replace(/\n\+/g,"\n");if(/\[\s*(\S.+)\s+pdfmark\b/.test(e)){e=RegExp.lastParen.replace(/(\d{4,6}) u/g,(t,s)=>s/this.sizeScale).replace(/\\\[u00(..)\]/g,(t,s)=>parseInt(s,16));if(/^\/Dest\s+\/?(\S+)(.*)\s+\/DEST$/.test(e)){const t=RegExp.$1;const s=RegExp.$2.match(/\/View\s+\[\/FitH\s+(-?[\d.]+)\s*\]/)||[0];this.anchors.set(t,{page:this.page,offset:+s.pop()});return}if(/^\/Dest\s+\/?(\S+)\s+\/Title\s+\((.+)\)\s+\/Level\s+(-?\d+)\s+\/OUT$/.test(e)){const t=Math.abs(RegExp.$3)||1;this.bookmarks.push({target:RegExp.$1,title:RegExp.$2,level:t});return}}break;case t.TEXT_NORMAL:if(this.fixKerning){this.buffer=this.buffer||[];this.buffer.push([s,e]);return}break;case t.MOVE_ABS_H:if(this.fixKerning&&null!==this.buffer){this.buffer.push([s,e]);return}}this.page.push([s,e])}resizeCanvas(){if(!this.autoScale)return;const{width:t,height:s}=this.page;const{canvas:e}=this.context;const i=window.devicePixelRatio;const o=Math.max(screen.availWidth,screen.availHeight)*i;const n=s/t;if(t<s){this.scale=t*this.unitWidth/o;e.width=o;e.height=o*n}else{this.scale=s*this.unitWidth/o;e.width=o*(t/s);e.height=o}}resolveOutline(t){const s=[];let e,i=1;for(let o of t){o.children=[];o.parent=null;let{level:t}=o;if(t>i){o.parent=e;e.children.push(o);i=t}else if(t<i)while(e){if(e.level<=t){i=e.level;e.parent?e.parent.children.push(o):s.push(o);o.parent=e.parent;break}e=e.parent}else{if(t>1){e=e.parent||e;e.children.push(o);o.parent=e}else s.push(o)}e=o}return s}render(s,e=null,i=true){if(null!==e)this.context=e;if(i)this.clearPage();this.resetDrawingState();this.page=s;this.resizeCanvas();for(const[s,e]of this.page){if(s===t.DEVICE_CTRL)super.exec(s,e);else if(this.invisible)continue;else super.exec(s,e)}}clearPage(){const{canvas:t}=this.context;this.context.clearRect(0,0,t.width,t.height)}drawArc(t){const s=this.x*this.scale;const e=this.y*this.scale;const i=+t[0];const o=+t[1];const n=+t[2];const a=+t[3];const r=i+n;const h=o+a;const c=r*r+h*h;if(0!==c){let t=.5-(i*r+o*h)/c;let l=i+t*r;let u=o+t*h;const p=Math.sqrt(l*l+u*u)/this.scale;const d=Math.atan2(-u,-l);const f=Math.atan2(o+a-u,i+n-l);l=(s+l)/this.scale;u=(e+u)/this.scale;this.context.beginPath();this.context.arc(l,u,p,d,f,true);this.context.stroke()}else{this.context.beginPath();this.context.moveTo(s/this.scale,e/this.scale);this.context.lineTo((r+s)/this.scale,(h+e)/this.scale);this.context.stroke()}this.x+=(i+n)/this.scale;this.y+=(o+a)/this.scale}drawCircle(t,s=false){const e=t/this.scale/2;this.context.beginPath();this.context.ellipse(this.x+e,this.y,e,e,0,0,2*Math.PI);this.x+=e*2;s?this.fill():this.context.stroke()}drawEllipse(t,s=false){const e=t[0]/this.scale/2;const i=t[1]/this.scale/2;this.context.beginPath();this.context.ellipse(this.x+e,this.y,e,i,0,0,2*Math.PI);this.x+=e*2;s?this.fill():this.context.stroke()}drawLine(t){this.context.moveTo(this.x,this.y);this.x+=+t[0]/this.scale;this.y+=+t[1]/this.scale;this.context.lineTo(this.x,this.y);this.context.stroke()}drawPolygon(t,s=false){this.context.beginPath();this.context.moveTo(this.x,this.y);let e=this.x;let i=this.y;let o=0;let n=0;const{length:a}=t;for(let s=0;s<a;s+=2){const a=t[s]/this.scale;const r=t[s+1]/this.scale;o+=a;n+=r;e=e+a;i=i+r;this.context.lineTo(e,i)}this.x+=o;this.y+=n;this.context.closePath();s?this.fill():this.context.stroke()}drawSpline(t){this.context.beginPath();this.context.moveTo(this.x,this.y);this.context.lineTo(this.x+=t[0]/2/this.scale,this.y+=t[1]/2/this.scale);const s=2;const e=3;const i=t.length-2;for(let o=0;o<i;o+=2){const i=(t[o]-t[o]/2+t[o+2]/2)/this.scale;const n=(t[o+1]-t[o+1]/2+t[o+3]/2)/this.scale;this.context.bezierCurveTo(this.x+t[o]*s/(2*e)/this.scale,this.y+t[o+1]*s/(2*e)/this.scale,this.x+(t[o]/2+t[o+2]*(e-s)/(2*e))/this.scale,this.y+(t[o+1]/2+t[o+3]*(e-s)/(2*e))/this.scale,this.x+i,this.y+n);this.x+=i;this.y+=n}this.x+=(t[i]-t[i]/2)/this.scale;this.y+=(t[i+1]-t[i+1]/2)/this.scale;this.context.lineTo(this.x,this.y);this.context.stroke()}fill(){this.context.fillStyle=this.drawColour;this.context.fill();this.context.fillStyle=this.colour}handleDeviceControl(t,...s){switch(t[0]){case"F":this.sourceFile=s.join(" ");break;case"f":this.mountFont(...s);break;case"H":this.charHeight=+s[0]/this.scale;if(this.charSize===this.charHeight)this.charHeight=0;this.updateTransformMatrix();break;case"r":this.res[0]=+s[0]||0;this.res[1]=+s[1]||0;this.res[2]=+s[2]||0;break;case"S":this.slant=+s[0]||0;this.updateTransformMatrix();break;case"X":this.handleExtendedDeviceControl(...s);break}}handleDrawingCommand(t,...s){switch(t[0]){case"~":this.drawSpline(s);break;case"a":this.drawArc(s);break;case"c":this.drawCircle(s[0]);break;case"C":this.drawCircle(s[0],true);break;case"e":this.drawEllipse(s);break;case"E":this.drawEllipse(s,true);break;case"l":this.drawLine(s);break;case"p":this.drawPolygon(s);break;case"P":this.drawPolygon(s,true);break;case"t":this.setLineThickness(s[0]);break;case"F":if(t.length>1)s.unshift(t.substr(1));const[e,...i]=s;this.drawColour=this.parseColour(e,i);break;case"f":this.drawColour=s[0]<0||s[0]>1e3?this.context.fillStyle:this.parseColour("G",s);break}}handleExtendedDeviceControl(t,...s){let e=false;switch(t){case"ps:":switch(s[0]){case"invis":this.invisible=true;break;case"endinvis":this.invisible=false;break;case"exec":const t=s.join(" ");if(/exec gsave currentpoint 2 copy translate .+ rotate neg exch neg exch translate/.test(t))this.setRotation(s[6]);else if("grestore"===s[1])this.setRotation(0);else if(/exec \d setline(cap|join)/.test(t))"cap"===RegExp.lastParen?this.context.lineCap=["butt","round","square"][s[1]]:this.context.lineJoin=["miter","round","bevel"][s[1]];else e=true;break;default:e=true}break;case"pdf:":switch(s[0]){case"markstart":this.hotspotStart(s);break;case"markend":this.hotspotEnd();break;case"marksuspend":this.hotspotHold=true;break;case"markrestart":this.hotspotHold=false;break;case"xrev":this.reversed=!this.reversed;this.updateTransformMatrix();break;default:e=true}break;default:e=true}if(e)this.devCmds.push({x:this.x,y:this.y,name:t,args:s})}informEOL(){if(null!==this.hotspot){this.hotspotEnd();this.hotspotWrap=true}}hotspotStart(t){this.hotspot=this.parseHotspot(t)}hotspotEnd(){if(null!==this.hotspot&&!this.hotspotHold){this.hotspot.width=this.x-this.hotspot.x+this.hotspot.lead;this.hotspots.push(this.hotspot);this.hotspot=null}}mountFont(t,s){const e=this.fontStyles[s];if(!e){console.warn(`Unrecognised font "${s}" will be rendered as sans-serif`);return["","px sans-serif"]}const i=e[0];const o=e.slice(1).reverse().join(" ");this.fonts[t]=[o?o+" ":"",`px ${i}`];this.fonts[t].name=s}moveByX(t){this.x+=+t/this.scale}moveByY(t){this.y+=+t/this.scale}moveToX(t){this.x=+t/this.scale}moveToY(t){this.y=+t/this.scale}moveThenPrint(t,s){this.x+=Math.floor(+t/this.res[1])/this.scale;this.print(s)}parseColour(t,s){switch(t[0]){case"c":s=s.map(t=>(1-Math.round(t/65536))*255);return`rgb(${s.join()})`;case"k":const[e,i,o,n]=args.map(t=>Math.round(t/65536));s=[255*(1-e)*(1-n),255*(1-i)*(1-n),255*(1-o)*(1-n)];return`rgb(${s.join()})`;case"r":s=s.map(t=>Math.round(t/257));return`rgb(${s.join()})`;case"G":s=[Math.round((1-s[0]/1e3)*65536)];case"g":s=new Array(3).fill(Math.round(s[0]/257));return`rgb(${s.join()})`;default:return"#000"}}parseHotspot(t){const s=(+t[1]+ +t[3])/this.scale;const i=(+t[2]-+t[3])/this.scale;const o=+t[3]/this.scale;const n=this.x-o;const a=this.y-s;const r=this.y-i-(this.y-s);const h=new e(n,a,0,r,o,t);h.parseExtraArgs(t.slice(4).join(" "));return h}parseLength(t){const s=t.substr(0,t.length-1);const e=t.substr(-1);switch(e){case"i":return parseInt(s*72);case"c":return parseInt(s*72/2.54);case"m":return parseInt(s*72/25.4);case"p":return+s;case"P":return s*6;case"z":return s/this.unitWidth;default:return NaN}}print(t){t=this.remapChars(t);this.context.save();if(null!==this.tm){if(this.reversed){t=t.split("").reverse().join("");const{width:s}=this.context.measureText(t);this.context.translate(s,0)}this.context.translate(this.x,this.y);this.context.transform(...this.tm);this.context.translate(-this.x,-this.y)}this.context.fillText(t,this.x,this.y);this.context.restore();if(true===this.hotspotWrap&&!this.hotspotHold){const t=this.hotspots[this.hotspots.length-1];t&&this.hotspotStart(t.rawArgs);this.hotspotWrap=false}}printChar(t){this.print(t)}printText(t){this.print(t);this.x+=this.context.measureText(t).width}printTrackedText(t,s){t/=this.scale;for(const e of s.split("")){const{width:s}=this.context.measureText(e);this.print(e);this.x+=s+t}}remapChars(t){const s=this.charMaps[this.font?this.font.name:"R"];if(s){let e="";const{length:i}=t;for(let o=0;o<i;++o){const i=t[o];const n=s[i];e+=n?String.fromCharCode(n):t}return e}else return t&&this.fixQuotes?t.replace(/`/g,"‘").replace(/'/g,"’"):t}setColour(t,s){this.colour=this.parseColour(t,s);this.context.fillStyle=this.colour;this.context.strokeStyle=this.colour}setFont(t){this.font=this.fonts[t];this.context.font=this.font[0]+this.charSize+this.font[1]}setLineThickness(t){let s=t/this.scale;if(s<0)s=this.res[0]/(72*this.sizeScale)*40*this.charSize/1e3;this.context.lineWidth=s;this.x+=s}setRotation(t){t=+t||0;if(!t&&this.rotated){this.context.restore();this.rotated=false}else{this.context.save();this.context.resetTransform();this.context.translate(this.x,this.y);this.context.rotate(t*Math.PI/180);this.context.translate(-this.x,-this.y);this.rotated=true}}setSize(t){this.charSize=+t/this.scale;this.context.font=this.font[0]+this.charSize+this.font[1];if(this.lineWidth<1){const t=this.res[0]/(72*this.sizeScale)*40*this.charSize/1e3;this.context.lineWidth=t;this.x+=t}}updateTransformMatrix(){if(!this.reversed&&0===this.slant&&0===this.charHeight)this.tm=null;else{this.tm=[1,0,0,1,0,0];const{charHeight:t,charSize:s,slant:e,tm:i}=this;if(0!==t)i[3]=t/s;if(0!==e){let o=-e;if(0!==t)o*=t/s;o=o*Math.PI/180;i[2]=Math.sin(o)/Math.cos(o)}if(this.reversed)i[0]=-i[0]}}}class e{constructor(t,s,e,i,o=0,n=null){this.x=t;this.y=s;this.width=e;this.height=i;this.lead=o;this.border={cornerRadiusH:0,cornerRadiusV:0,colour:[0,0,0],dashGaps:[],thickness:0};if(n)this.rawArgs=n}draw(t){if(!this.border.thickness)return;t.save();t.lineCap="butt";t.lineJoin="miter";t.lineWidth=this.border.thickness;t.setLineDash(this.border.dashGaps);t.strokeStyle="rgb("+this.border.colour.join(", ")+")";t.strokeRect(this.x,this.y,this.width,this.height);t.restore()}parseExtraArgs(t){t=t.replace(/\s*\/Border\s+\[([^\[\]]+)\s*(?:\[([^\]]+)\]\s*)?\]/,(t,s,e)=>{s=s.trim().split(/\s+/);this.border.cornerRadiusH=+s[0]||0;this.border.cornerRadiusV=+s[1]||0;this.border.thickness=+s[2]||0;if(e){e=e.trim().split(/\s+/).map(t=>+t);this.border.dashGaps=e}return""}).replace(/\s*\/Color\s*\[([^\]]+)\]/,(t,s)=>{s=s.trim().split(/\s+/).map(t=>Math.round(+t*255)||0);this.border.colour=s;return""}).replace(/\/Subtype\s+\/Link\s+(.+)/,(t,s)=>{if(/^\/Dest\s+\/(\S+)\s*$/.test(s))this.targetDest=RegExp.lastParen;else if(/^\s*\/Action\s+<<\s*\/Subtype\s+\/URI/.test(s))this.targetURI=s.match(/\/URI\s+\((\S*)\)\s+>>/)[1];return""}).trim();if(t)this.unparsedArgs=t}}e.prototype.rawArgs=null;e.prototype.unparsedArgs="";return s}();const TroffView=function(){const t=Symbol("TroffViewHotspots");const s=Symbol("TroffViewHotspot");const e=Symbol("TroffViewCanvas");const i=Symbol("TroffViewContext");const o=new Set;const n=new Set;class a{constructor(t={}){const s=t.parentElement||null;delete t.parentElement;Object.assign(this,t);const{classNames:e}=this;this.root=this.div(e.root);this.zoomLayer=this.div(e.zoomLayer);this.pagesList=this.div(e.pagesList);this.zoomLayer.appendChild(this.pagesList);this.root.appendChild(this.zoomLayer);s&&s.appendChild(this.root);this.renderer=new CanvasRenderer;this.fontListener=(()=>this.refresh());document.fonts.addEventListener("loadingdone",this.fontListener)}div(t={}){const s=document.createElement("div");if("string"===typeof t)t={className:t};return Object.assign(s,t||{})}load(t){this.renderer.process(t);this.numPages=this.renderer.pages.length-1;this.refresh()}loadFile(t){return new Promise((s,e)=>{readFile(t,"utf8",(t,i)=>t?e(t):s(i))}).then(t=>this.load(t)).catch(s=>{console.error(`[TroffView::loadFile] Error loading ${t}`);console.dir(s)})}refresh(){const{numPages:t}=this;for(let s=0;s<t;++s){const t=this.renderer.pages[s+1];if(!t)return;const e=this.pagesList.children[s];const o=e[i];this.renderer.render(t,o);const n=Math.round(t.width/this.renderer.maxPageWidth*100);e.style.width=`${n/this.spreadSize}%`;this.setHotspots(this.renderer.hotspots,e)}}get pages(){return this.pagesList?Array.from(this.pagesList.children):[]}get numPages(){return this.pagesList?this.pagesList.childElementCount:0}set numPages(t){const s=this.pagesList.children;const e=s.length;t=Math.max(1,+t||1);if(t>e)for(let s=e;s<t;++s)this.pagesList.appendChild(this.addPage());else if(t<e)for(const e of Array.from(s).slice(t))this.removePage(e)}get spreadSize(){return+this.pagesList.dataset.spreadSize||1}set spreadSize(t){const{dataset:s}=this.pagesList;const e=+s.spreadSize||1;t=Math.max(1,+t||1);if(t!==e){t>1?s.spreadSize=t:delete s.spreadSize;this.refresh()}}addPage(){if(o.size){const t=Array.from(o)[0];o.delete(t);return t}const s=this.div(this.classNames.page);const n=this.div(this.classNames.hotspotList);const a=document.createElement("canvas");const r=a.getContext("2d");const h=this.getCanvasSize();a.width=h;a.height=h;Object.defineProperties(s,{[t]:{value:n},[e]:{value:a},[i]:{value:r}});s.appendChild(a);s.appendChild(n);return s}removePage(t){if(t&&this.pagesList.contains(t)){this.pagesList.removeChild(t);o.add(t)}}getCanvasSize(){const t=screen.availWidth;const s=screen.availHeight;const e=window.devicePixelRatio;return Math.max(t,s)*e}setHotspots(s,o){const n=o[t];const{children:a}=n;const r=a.length;const h=s.length;if(h>r)for(let t=r;t<h;++t){const e=s[t];const i=this.addHotspot(e);n.appendChild(i)}else if(h<r)for(const t of Array.from(a).slice(h))this.removeHotspot(t);const c=o[i];const{width:l,height:u}=o[e];for(let t=0;t<h;++t){const e=s[t];this.setHotspotBounds(a[t],e,l,u);if(this.showHotspots&&!e.border.thickness){e.border.thickness=2;e.draw(c);e.border.thickness=0}else e.draw(c)}}addHotspot(t){const e=this.div("troff-view-hotspot");e[s]=t;e.addEventListener("click",t=>{const i=e[s];if(!i)return;if(i.targetURI)window.location.replace(i.targetURI);else if(i.targetDest)this.goToAnchor(i.targetDest);t.preventDefault();return false});return e}setHotspotBounds(t,s,e,i){const{style:o}=t;o.left=`${s.x/e*100}%`;o.top=`${s.y/i*100}%`;o.right=`${(e-(s.x+s.width))/e*100}%`;o.bottom=`${(i-(s.y+s.height))/i*100}%`}get page(){const t=this.calculateVisibility().map((t,s)=>[s,t]).sort((t,s)=>{if(t[1]>s[1])return-1;if(t[1]<s[1])return 1;if(t[0]<s[0])return-1;if(t[0]>s[0])return 1;return 0});return(t[0]||[0])[0]}set page(t){if(!this.pagesList)return;const s=this.pagesList.children;const e=s.length;if(t<=0)this.root.scrollTop=0;else{if(t>=e)t=e-1;const i=s[t];if(!i)return;this.root.scrollTop=i.offsetTop}}goToAnchor(t){const{anchors:s}=this.renderer;const e=s.get(t);if(e)this.page=e.page.index-1}calculateVisibility(){const{numPages:t}=this;const s=new Array(t);const e=this.root.getBoundingClientRect();for(let i=0;i<t;++i){const t=this.pagesList.children[i];const o=t.getBoundingClientRect();const{top:n,bottom:a,height:r}=o;if(a<e.top||n>e.bottom)s[i]=0;else{let t=0;if(n<e.top)t+=Math.abs(e.top-n);if(a>e.bottom)t+=Math.abs(e.bottom-a);s[i]=1-t/r}}return s}}Object.assign(a.prototype,{classNames:{root:"troff-view",zoomLayer:"troff-view-zoom",pagesList:"troff-view-pages",page:"troff-view-page",hotspotList:"troff-view-hotspots",hotspot:"troff-view-hotspot"},showHotspots:false});return a}();window.TroffView=TroffView;"use strict";window.PanAndZoom=function(){const t=Number.NEGATIVE_INFINITY;const s=Number.POSITIVE_INFINITY;const e=(t,s,e)=>Math.min(Math.max(t,s),e);return class i{constructor(i={}){if("function"===typeof i)i={update:i};let{panX:o=0,panY:n=0,minPanX:a=t,minPanY:r=t,maxPanX:h=s,maxPanY:c=s,zoom:l=1,minZoom:u=0,maxZoom:p=s,originX:d=0,originY:f=0,minOriginX:m=t,minOriginY:g=t,maxOriginX:b=s,maxOriginY:x=s,update:k=(()=>{}),updatePan:L=(()=>{}),updateZoom:S=(()=>{}),updateOrigin:y=(()=>{}),updateDelay:C=0,updateEarly:N=true}=i;const w={update:null,updatePan:null,updateZoom:null,updateOrigin:null};Object.defineProperties(this,{transform:{get:()=>this.mergeMatrices([1,0,o,0,1,n,0,0,1],[1,0,d,0,1,f,0,0,1],[l,0,0,0,l,0,0,0,1],[1,0,-d,0,1,-f,0,0,1])},pan:{get:()=>[o,n],set:t=>{const s=o;const i=n;const l=e(+t[0]||0,a,h);const u=e(+t[1]||0,r,c);if(l!==s||u!==i){o=l;n=u;this.updatePan([s,i],[l,u]);this.update()}}},panX:{get:()=>o,set:t=>{const s=o;t=e(+t||0,a,h);if(t!==s){o=t;this.updatePan([s,n],[t,n]);this.update()}}},panY:{get:()=>n,set:t=>{const s=n;t=e(+t||0,r,c);if(t!==s){n=t;this.updatePan([o,s],[o,t]);this.update()}}},minPanX:{get:()=>a,set:t=>{a=Math.min(+t||0,h);if(o<a)this.panX=a}},minPanY:{get:()=>r,set:t=>{r=Math.min(+t||0,c);if(n<r)this.panY=r}},maxPanX:{get:()=>h,set:t=>{h=Math.max(+t||0,a);if(o>h)this.panX=h}},maxPanY:{get:()=>c,set:t=>{c=Math.max(+t||0,r);if(n>c)this.panY=c}},origin:{get:()=>[d,f],set:t=>{const s=d;const i=f;const o=e(+t[0]||0,m,b);const n=e(+t[1]||0,g,x);if(o!==s||n!==i){d=o;f=n;this.updateOrigin([s,i],[o,n]);this.update()}}},originX:{get:()=>d,set:t=>{const s=d;t=e(+t||0,m,b);if(t!==s){d=t;this.updateOrigin([s,f],[t,f]);this.update()}}},originY:{get:()=>f,set:t=>{const s=f;t=e(+t||0,g,x);if(t!==s){f=t;this.updateOrigin([d,s],[d,t]);this.update()}}},minOriginX:{get:()=>m,set:t=>{m=Math.min(+t||0,b);if(d<m)this.originX=m}},minOriginY:{get:()=>g,set:t=>{g=Math.min(+t||0,x);if(f<g)this.originY=g}},maxOriginX:{get:()=>b,set:t=>{b=Math.max(+t||0,m);if(d>b)this.originX=b}},maxOriginY:{get:()=>x,set:t=>{x=Math.max(+t||0,g);if(f>x)this.originY=x}},zoom:{get:()=>l,set:t=>{const s=l;t=e(+t||0,u,p);if(t!==s){l=t;this.updateZoom(s,t);this.update()}}},minZoom:{get:()=>u,set:t=>{u=Math.min(+t||0,p);if(l<u)this.zoom=u}},maxZoom:{get:()=>p,set:t=>{p=Math.max(+t||0,u);if(l>p)this.zoom=p}},update:{get:()=>w.update||k,set:t=>{if("function"!==typeof t)return;k=t;w.update=this.debounce(t)}},updateOrigin:{get:()=>w.updateOrigin||y,set:t=>{if("function"!==typeof t)return;k=t;w.updateOrigin=this.debounce(t)}},updatePan:{get:()=>w.updatePan||L,set:t=>{if("function"!==typeof t)return;k=t;w.updatePan=this.debounce(t)}},updateZoom:{get:()=>w.updateZoom||S,set:t=>{if("function"!==typeof t)return;k=t;w.updateZoom=this.debounce(t)}},updateDelay:{get:()=>C,set:t=>{const s=C;t=Math.max(-1,+t||0);if(t!==s){t=s;v()}}},updateEarly:{get:()=>N,set:t=>{const s=N;if((t=!!t)!==s){t=s;v()}}}});const v=()=>{this.update=k;this.updateOrigin=y;this.updatePan=L;this.updateZoom=S};v()}applyTransform(t){const s=[];for(const e of t){const t=this.mergeMatrices(this.transform,[1,0,e[0],0,1,e[1],0,0,1]);s.push([t[2],t[5]])}return s}mergeMatrices(...t){let s=t[0]||[1,0,0,0,1,0,0,0,1];if(t.length<2)return s;const{length:e}=t;for(let i=1;i<e;++i){const[e,o,n,a,r,h,c,l,u]=s;const[p,d,f,m,g,b,x,k,L]=t[i];s=[e*p+o*m+n*x,e*d+o*g+n*k,e*f+o*b+n*L,a*p+r*m+h*x,a*d+r*g+h*k,a*f+r*b+h*L,c*p+l*m+u*x,c*d+l*g+u*k,c*f+l*b+u*L]}return s}debounce(t){const s=this.updateDelay;const e=this.updateEarly;if(s<0)return t;let i,o,n,a;const r=function(){const h=Date.now()-i;if(h>=s){if(!e)t.apply(o,n);if(a)clearTimeout(a);a=o=n=null}else a=setTimeout(r,s-h)};return function(){o=this,n=arguments;if(!s)return t.apply(o,n);i=Date.now();if(!a){if(e)t.apply(o,n);a=setTimeout(r,s)}}}toString(){const[t,s,e,i,o,n]=this.transform;return`matrix(${[t,i,s,o,e,n].join()})`}}}();(function(){"use strict";const t=t=>document.querySelector(t);const s=t("#toolbar");const e=t("#spread-size");const i=t("#zoom-amount");const o=t("#bookmarks");const n=o[0];t("#open-editor").addEventListener("click",()=>f());e.addEventListener("change",t=>g.spreadSize=+e.value);i.addEventListener("change",t=>g.panAndZoom.zoom=+i.value);o.addEventListener("change",t=>g.goToAnchor(o.value));function a(){o.appendChild(n);o.disabled=true}function r(){o.innerHTML="";if(!g.renderer.bookmarks.length)a();else{o.disabled=false;for(const t of g.renderer.bookmarks){h(t);t.children.map(t=>h(t))}}}function h(t){const s=document.createElement("option");s.value=t.target;s.textContent="  ".repeat(t.level-1)+t.title;o.appendChild(s)}const c=t("#overlay");const l=t("#editor");const u=t("#editor-input");let p=false;let d="";function f(){if(p)return;c.hidden=false;p=true;d=u.value;u.focus();u.select()}function m(t=false){u.blur();c.hidden=true;p=false;t?b():u.value=d}t("#editor-update").addEventListener("click",()=>m(true));t("#editor-cancel").addEventListener("click",()=>m());window.addEventListener("keyup",t=>{if(p&&27===t.keyCode)m()});const g=new TroffView({parentElement:t("#viewport")});b();g.spreadSize=+e.value;g.panAndZoom=new PanAndZoom({update:()=>g.zoomLayer.style.transform=g.panAndZoom});function b(){g.load(u.value);r()}window.view=g})();
